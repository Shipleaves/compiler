Source Program:
var a;
procedure A;
	var b, c;
	procedure B;
		var c;
    		begin
      			c := 1; 
      			b := c + 2;
    		end;
  	begin
    		call B;
    		c := b + 4;
    		a := c + 5;
  	end;
begin
	call A;
	if a < 0 then
		a := -1
	else
		a :=  a + 1;
		write a;
end.

Lexeme Table:
lexeme		token type
var		29
a		2
;		18
procedure	30
A		2
;		18
var		29
b		2
,		17
c		2
;		18
procedure	30
B		2
;		18
var		29
c		2
;		18
begin		21
c		2
:=		20
1		3
;		18
b		2
:=		20
c		2
+		4
2		3
;		18
end		22
;		18
begin		21
call		27
B		2
;		18
c		2
:=		20
b		2
+		4
4		3
;		18
a		2
:=		20
c		2
+		4
5		3
;		18
end		22
;		18
begin		21
call		27
A		2
;		18
if		23
a		2
<		11
0		3
then		24
a		2
:=		20
-		5
1		3
else		33
a		2
:=		20
a		2
+		4
1		3
;		18
write		31
a		2
;		18
end		22
.		19


Generated Code:
0: 6 0 0 4
1: 6 0 0 0
2: 6 0 0 1
3: 7 0 0 28
4: 6 0 0 4
5: 6 0 0 0
6: 6 0 0 2
7: 7 0 0 18
8: 6 0 0 4
9: 6 0 0 0
10: 6 0 0 1
11: 1 0 0 1
12: 4 0 0 4
13: 3 1 0 4
14: 1 2 0 2
15: 13 1 1 2
16: 4 1 1 4
17: 2 0 0 0
18: 5 0 1 8
19: 3 2 0 4
20: 1 3 0 4
21: 13 2 2 3
22: 4 2 0 5
23: 3 3 0 5
24: 1 4 0 5
25: 13 3 3 4
26: 4 3 1 4
27: 2 0 0 0
28: 5 0 0 4
29: 3 4 0 4
30: 1 5 0 0
31: 21 6 4 5
32: 8 6 0 37
33: 1 7 0 1
34: 12 7 7 0
35: 4 7 0 4
36: 7 0 0 41
37: 3 8 0 4
38: 1 9 0 1
39: 13 8 8 9
40: 4 8 0 4
41: 3 9 0 4
42: 9 9 0 1
43: 11 0 0 3

The program is syntactically correct.


VM Execution Trace
Line	OP	R	L	M
  0     inc     0       0       4
  1     inc     0       0       0
  2     inc     0       0       1
  3     jmp     0       0      28
  4     inc     0       0       4
  5     inc     0       0       0
  6     inc     0       0       2
  7     jmp     0       0      18
  8     inc     0       0       4
  9     inc     0       0       0
 10     inc     0       0       1
 11     lit     0       0       1
 12     sto     0       0       4
 13     lod     1       0       4
 14     lit     2       0       2
 15     add     1       1       2
 16     sto     1       1       4
 17     rtn     0       0       0
 18     cal     0       1       8
 19     lod     2       0       4
 20     lit     3       0       4
 21     add     2       2       3
 22     sto     2       0       5
 23     lod     3       0       5
 24     lit     4       0       5
 25     add     3       3       4
 26     sto     3       1       4
 27     rtn     0       0       0
 28     cal     0       0       4
 29     lod     4       0       4
 30     lit     5       0       0
 31     lss     6       4       5
 32     jpc     6       0      37
 33     lit     7       0       1
 34     neg     7       7       0
 35     sto     7       0       4
 36     jmp     0       0      41
 37     lod     8       0       4
 38     lit     9       0       1
 39     add     8       8       9
 40     sto     8       0       4
 41     lod     9       0       4
 42     sio     9       0       1
 43     sio     0       0       3

Inital Values			pc    bp    sp
  1     inc    0    0    4       1     1     4    0    0    0    0
  2     inc    0    0    0       2     1     4    0    0    0    0
  3     inc    0    0    1       3     1     5    0    0    0    0    0
  4     jmp    0    0   28      28     1     5    0    0    0    0    0
 29     cal    0    0    4       4     6     5    0    0    0    0    0
  5     inc    0    0    4       5     6     9    0    0    0    0    0    |     0    1    1   29
  6     inc    0    0    0       6     6     9    0    0    0    0    0    |     0    1    1   29
  7     inc    0    0    2       7     6    11    0    0    0    0    0    |     0    1    1   29    0    0
  8     jmp    0    0   18      18     6    11    0    0    0    0    0    |     0    1    1   29    0    0
 19     cal    0    1    8       8    12    11    0    0    0    0    0    |     0    1    1   29    0    0
  9     inc    0    0    4       9    12    15    0    0    0    0    0    |     0    1    1   29    0    0    |     0    1    6   19
 10     inc    0    0    0      10    12    15    0    0    0    0    0    |     0    1    1   29    0    0    |     0    1    6   19
 11     inc    0    0    1      11    12    16    0    0    0    0    0    |     0    1    1   29    0    0    |     0    1    6   19    0
 12     lit    0    0    1      12    12    16    0    0    0    0    0    |     0    1    1   29    0    0    |     0    1    6   19    0
 13     sto    0    0    4      13    12    16    0    0    0    0    0    |     0    1    1   29    0    0    |     0    1    6   19    1
 14     lod    1    0    4      14    12    16    0    0    0    0    0    |     0    1    1   29    0    0    |     0    1    6   19    1
 15     lit    2    0    2      15    12    16    0    0    0    0    0    |     0    1    1   29    0    0    |     0    1    6   19    1
 16     add    1    1    2      16    12    16    0    0    0    0    0    |     0    1    1   29    0    0    |     0    1    6   19    1
 17     sto    1    1    4      17    12    16    0    0    0    0    0    |     0    1    1   29    3    0    |     0    1    6   19    1
 18     rtn    0    0    0      19     6    11    0    0    0    0    0    0    1    1   29    3    0
 20     lod    2    0    4      20     6    11    0    0    0    0    0    0    1    1   29    3    0
 21     lit    3    0    4      21     6    11    0    0    0    0    0    0    1    1   29    3    0
 22     add    2    2    3      22     6    11    0    0    0    0    0    0    1    1   29    3    0
 23     sto    2    0    5      23     6    11    0    0    0    0    0    0    1    1   29    3    7
 24     lod    3    0    5      24     6    11    0    0    0    0    0    0    1    1   29    3    7
 25     lit    4    0    5      25     6    11    0    0    0    0    0    0    1    1   29    3    7
 26     add    3    3    4      26     6    11    0    0    0    0    0    0    1    1   29    3    7
 27     sto    3    1    4      27     6    11    0    0    0    0   12    0    1    1   29    3    7
 28     rtn    0    0    0      29     1     5    0    0    0    0   12
 30     lod    4    0    4      30     1     5    0    0    0    0   12
 31     lit    5    0    0      31     1     5    0    0    0    0   12
 32     lss    6    4    5      32     1     5    0    0    0    0   12
 33     jpc    6    0   37      37     1     5    0    0    0    0   12
 38     lod    8    0    4      38     1     5    0    0    0    0   12
 39     lit    9    0    1      39     1     5    0    0    0    0   12
 40     add    8    8    9      40     1     5    0    0    0    0   12
 41     sto    8    0    4      41     1     5    0    0    0    0   13
 42     lod    9    0    4      42     1     5    0    0    0    0   13
 43     sio    9    0    1      43     1     5    0    0    0    0   13
Program Output: 13

 44     sio    0    0    3      44     1     5    0    0    0    0   13